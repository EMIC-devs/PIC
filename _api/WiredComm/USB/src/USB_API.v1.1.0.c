/*************************************************************************//**  @file     USB_API.c  @brief    Driver Library to use USB  @author   Tomas Pentacolo (based on Pablo Llull (PL))  @date     23/11/2022  @version  v0.0.1 - Initial release.   ******************************************************************************/void USB_Init(){	Init_USBDriver();}#if USBprot=="EMIC_message"void pUSB(char* format,...){	va_list arg;    va_start(arg, format);	sendDataToStream(&streamOut_Uart.{puerto}.,format,arg);	va_end(arg);	UARTX.{puerto}._OUT_push(USBFrameLf); }#elsevoid pUSB(char* msg){	char *r;		for (r = char* msg;*r > 0; r++) 	{		UARTX.{puerto}._OUT_push(*r);	}	UARTX.{puerto}._OUT_push(USBFrameLf);}#endif/*//#if USBprot=="STREAM"//void gUSB(void)//{//	char r;////	if (UARTX.{puerto}._IN_n_frame > 0)//	{//		putc_rsp('�');////		while (UARTX.{puerto}._IN_n_frame > 0)//		{//			r=UARTX.{puerto}._IN_pop(0);//			putc_rsp(r);//		}//		putc_rsp('�');//	}//}////doCMDf(gUSB)//#endif*/void Poll_USB(void){EMIC:ifdef(usedEvent.eUSB)
	if (UARTX.{puerto}.InStream.frame_count > 0)	{		streamOpenReadFrame(&UARTX.{puerto}.InStream);		#if USBprot=="EMIC_message"		char tag[20];		char d;		uint8_t i = 0;			d = UARTX.{puerto}._IN_pop();		while (UARTX.{puerto}.InStream.data_count_sal && d != '\t' && i < 20)		{			tag[i++] = d;			d = UARTX.{puerto}._IN_pop();		}				tag[i] = 0;				eUSB(tag,&streamIn_Uart.{puerto}.);EMIC:endif
							}EMIC:endif
EMIC:ifdef(usedEvent.eBeUSB)
	if(UARTX.{puerto}._bufferEmpty) 	{		UARTX.{puerto}._bufferEmpty=0;		eBeUSB();		//puts_f("#eBeUSB;\r"); //se vacio el buffer tx	}EMIC:endif
}uint16_t USB_sendCount(void){	return UARTX.{puerto}.OutStream.data_count_sal;}